---
title: Roman Emperors - r/dataisbeautiful
author: David Mas
date: '2018-08-02'
slug: roman-emperors-r-dataisbeautiful
categories:
  - R
tags:
  - dataisbeautiful
header:
  caption: ''
  image: ''
---



<pre class="r"><code>library(magrittr)
library(ggplot2)
library(extrafont)</code></pre>
<pre><code>## Registering fonts with R</code></pre>
<pre class="r"><code>loadfonts(device = &quot;win&quot;,quiet = TRUE)
url = &quot;https://raw.githubusercontent.com/zonination/emperors/master/emperors.csv&quot;
dat = readr::read_csv(url)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   index = col_integer(),
##   name = col_character(),
##   name.full = col_character(),
##   birth = col_date(format = &quot;&quot;),
##   death = col_date(format = &quot;&quot;),
##   birth.cty = col_character(),
##   birth.prv = col_character(),
##   rise = col_character(),
##   reign.start = col_date(format = &quot;&quot;),
##   reign.end = col_date(format = &quot;&quot;),
##   cause = col_character(),
##   killer = col_character(),
##   dynasty = col_character(),
##   era = col_character(),
##   notes = col_character(),
##   verif.who = col_character()
## )</code></pre>
<pre class="r"><code>dat$century = ceiling(lubridate::year(dat$reign.end)/100)

total = nrow(dat)</code></pre>
<pre class="r"><code>p1 = dat %&gt;% dplyr::select(birth.prv,rise,cause,killer,dynasty,era,century) %&gt;%
  tidyr::gather(&quot;var&quot;,&quot;val&quot;,-cause) %&gt;%
  dplyr::group_by(cause,var,val) %&gt;%
  dplyr::summarise(n = n()) %&gt;%
  ggplot(aes(x = cause,val,fill = n)) +
  geom_tile(colour=&quot;gray20&quot;,size=1) +
  facet_grid(var~.,
             scales = &quot;free&quot;,
             space = &quot;free&quot;)+
  labs(x = &quot;Cause of death&quot;,
       fill = &quot;&quot;) +
  viridis::scale_fill_viridis(option = &quot;A&quot;, direction = -1, begin = 0.2,
                              end = 0.9) +
  theme(axis.text.x = element_text(angle = 90),
        axis.text = element_text(color = &quot;white&quot;,
                                 family = &quot;Lato&quot;),
        axis.title = element_text(color = &quot;white&quot;,
                                  family = &quot;Montserrat SemiBold&quot;),
        axis.title.y = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_blank()) +
  theme(strip.background = element_rect(colour = NA, fill = NA),
        strip.text = element_text(color = &quot;white&quot;,family = &quot;Montserrat&quot;),
        strip.placement = &quot;outside&quot;) +
  theme(legend.background = element_rect(fill = NA),
        legend.box.background = element_rect(fill = NA,linetype = &quot;blank&quot;),
        legend.box.spacing = unit(1.5, &quot;lines&quot;),
        legend.title = element_text(color = &quot;white&quot;),
        legend.position = &quot;bottom&quot;,
        legend.text = element_text(color = &quot;white&quot;)) +
  theme(panel.border = element_rect(linetype = &quot;blank&quot;, fill = NA,
                                    color = &quot;white&quot;),
        panel.background = element_blank(),
        panel.spacing = unit(1.5, &quot;lines&quot;),
        panel.grid = element_blank()) +
  theme(plot.background = element_rect(fill = &quot;gray20&quot;,color = NA))
print(p1)</code></pre>
<p><img src="/post/2018-08-02-roman-emperors-r-dataisbeautiful_files/figure-html/unnamed-chunk-2-1.png" width="1440" /></p>
<pre class="r"><code># obtain the length
dat$reign.start = as.numeric(dat$reign.start,&quot;days&quot;) 
dat$reign.end = as.numeric(dat$reign.end,&quot;days&quot;)
time0 = as.numeric(lubridate::date(&quot;0001-01-01&quot;),&quot;days&quot;)
dat$len = dat$reign.end - dat$reign.start
dat[1,&quot;len&quot;] = (dat[1,]$reign.end - time0) + (dat[1,]$reign.start - time0)</code></pre>
<pre class="r"><code>col_pallete  = c(&#39;#a6cee3&#39;,
                 &#39;#1f78b4&#39;,
                 &#39;#b2df8a&#39;,
                 &#39;#33a02c&#39;,
                 &#39;#fb9a99&#39;,
                 &#39;#e31a1c&#39;,
                 &#39;#fdbf6f&#39;)</code></pre>
<pre class="r"><code>p2 = ggplot(dat,aes(x = forcats::fct_reorder(name,.x = -index,.fun = mean),
               y=as.numeric(len),
               color = cause)) +
  geom_point(stat = &quot;identity&quot;) +
  geom_segment(aes(x = name,xend = name, y = 0,yend = as.numeric(len))) +
  facet_grid(century~.,scales = &quot;free&quot;,space = &quot;free&quot;) + 
  coord_flip() + 
  labs(y = &quot;Days in power*&quot;, color = &quot;Cause of death&quot;) +
  scale_color_manual(values = col_pallete) +
  scale_y_sqrt(breaks = c(500,1000,1500,5000,10000,15000)) +
  theme(axis.text.x = element_text(angle = 90),
        axis.text = element_text(color = &quot;white&quot;,
                                 family = &quot;Lato&quot;),
        axis.title = element_text(color = &quot;white&quot;,
                                  family = &quot;Montserrat SemiBold&quot;),
        axis.title.y = element_blank(),
        axis.ticks = element_blank(),
        axis.line = element_blank()) +
  theme(strip.background = element_rect(colour = NA, fill = NA),
        strip.text = element_text(color = &quot;white&quot;,family = &quot;Montserrat&quot;),
        strip.placement = &quot;outside&quot;) +
  theme(legend.background = element_rect(fill = NA),
        legend.box.background = element_rect(fill = NA,linetype = &quot;blank&quot;),
        legend.box.spacing = unit(1.5, &quot;lines&quot;),
        legend.key = element_blank(),
        legend.position = &quot;bottom&quot;,
        legend.title = element_text(color = &quot;white&quot;,family =  &quot;Montserrat&quot;),
        legend.text = element_text(color = &quot;white&quot;,family = &quot;Lato&quot;)) +
  theme(panel.border = element_rect(linetype = &quot;blank&quot;, 
                                    fill = NA,
                                    color = &quot;white&quot;),
        panel.background = element_blank(),
        panel.spacing = unit(1.5, &quot;lines&quot;),
        panel.grid = element_blank()) +
  theme(plot.background = element_rect(fill = &quot;gray20&quot;,color = NA))</code></pre>
<pre class="r"><code>fp = cowplot::plot_grid(p1,p2,rel_widths = c(1,1.5))
print(fp)</code></pre>
<p><img src="/post/2018-08-02-roman-emperors-r-dataisbeautiful_files/figure-html/unnamed-chunk-6-1.png" width="1920" /></p>
<pre class="r"><code># optionally, save plot
ggsave(plot = fp,filename = &quot;plot.svg&quot;,device = &quot;svg&quot;,width = 10,height = 11)</code></pre>
<p>After a few touches wih inkscape I ended up with this <a href="https://www.reddit.com/r/dataisbeautiful/comments/8ubnx1/roman_emperor_cause_of_death_oc/">reddit post</a>.</p>
