---
title: "ggridges for visualizing PCA"
author: "null"
date: '2018-12-01'
header:
  caption: ''
  image: ''
slug: ggridges-for-visualizing-pca
tags: []
categories: []
---

First things first, computing the PCA without the `cyl`variable that afterwards will be used as factor variable to plot the loadings of the PCA. I also center and scale the PCA becuase the units in each variable are different. 

```{r}
library(magrittr)
mtcars %>% head
mtcars2 = mtcars[,-2]
pca = prcomp(x = mtcars2,center = T,scale. = T)
```



Usually the classical representation of a PCA is a scattter plot between 2 components. This is helpful when you try to distinguish 2 groups because it maximizes the use of more components to separate the possible clusters.

```{r}
suppressPackageStartupMessages(library(ggfortify))

autoplot(pca,data = mtcars, colour = 'cyl')
```


However, if we are interested in how a single categorical variable is represented then this representation gets unreadable. Instead of focusing in the differentiation of the points in 2 dimensions we should focus in one dimension only. You could do a boxplot but I sometimes feel like the horitzontal axis is more useful when you try to increase the differences between groups.

A possibility 

```{r fig.height=7, fig.width=10, message=FALSE, warning=FALSE}

pca_df = pca$x %>% as.data.frame() %>% dplyr::mutate(inst = rownames(.)) 
mtcars_df = mtcars %>% as.data.frame() %>% dplyr::mutate(inst = rownames(.))

df = dplyr::inner_join(mtcars_df,pca_df)


library(ggplot2)
library(ggridges)
df = df %>% tidyr::gather("PC","weight",tidyselect::contains("PC") ) 
df$PC = forcats::fct_relevel(df$PC,glue::glue("PC{1:10}"))


fp = df %>%ggplot(aes(x = weight,fill=factor(cyl),y=factor(cyl))) + 
  geom_density_ridges(jittered_points = TRUE,
                      position = position_points_jitter(width = 0.05,
                                                        height = 0),
                      point_shape = '|', point_size = 3, alpha = 0.7) +
  facet_wrap(~PC, scales = "free")


fp + theme_minimal()

```
